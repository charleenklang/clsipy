<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Common LaTeX Service Interface Documentation</title>

    <link type="text/css" rel="stylesheet" href="assets/css/reset.css">
    <link type="text/css" rel="stylesheet" href="http://yandex.st/highlightjs/6.1/styles/github.min.css">
    <link type="text/css" rel="stylesheet" href="assets/css/docs.css">
    <link type="text/css" rel="stylesheet" href="assets/css/print.css" media="print">
    

    <script type="text/javascript" src="assets/js/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
    <script type="text/javascript" src="assets/js/lunr.min.js"></script>

    

    <script type="text/javascript">var BASE_URL = "";</script>
    <script type="text/javascript" src="assets/js/viewer.js"></script>

    
</head>
<body>
    <div id="page">
        <a name="top" />
        <header id="header">
            <h1><a href="">Common LaTeX Service Interface Documentation</a></h1>
        </header>
        

<div id="sidebar">
    <form action="search.html"><input id="search" type="text" placeholder="Search" name="q" /></form>
    <nav id="toc">
        
    <ol>
    
        <li>
            <a href="index.html#common-latex-service-interface">Common LaTeX Service Interface</a>
            
                
    <ol>
    
        <li>
            <a href="access.html#accessing-the-clsi">Accessing the CLSI</a>
            
        </li>
    
        <li>
            <a href="request.html#request-format">Request Format</a>
            
        </li>
    
        <li>
            <a href="response.html#response-format">Response Format</a>
            
        </li>
    
        <li>
            <a href="async.html#asynchronous-compiling">Asynchronous Compiling</a>
            
        </li>
    
        <li>
            <a href="install.html#installation">Installation</a>
            
        </li>
    
        <li>
            <a href="license.html#license">License</a>
            
        </li>
    
</ol>

            
        </li>
    
</ol>

    </nav>
    
    <nav id="links">
        <ul>
            
            <li><a href="http://github.com/pacbard/clsipy">View on GitHub</a></li>
            
        </ul>
    </nav>
    
</div>

        <div id="content">
            <a name="common-latex-service-interface"></a><h1>Common LaTeX Service Interface</h1>
<p>The Common LaTeX Service Interface (CLSI) is an HTTP RESTful API for compiling LaTeX
documents online.</p>
<a name="how-to-get-access"></a><h3>How to get access</h3>
<p>To access the CLSI server you will need a developer token. To request a
token, please email the server maintainer. </p>
<a name="how-to-report-a-missing-package"></a><h3>How to report a missing package</h3>
<p>If the CLSI maintainer decided to run a striped-down version of LaTeX,
it is possible that some packages are not installed by default. Please
contact the CSLI maintainer for more information regarding missing
packages.</p>
<a name="client"></a><h3>Client</h3>
<p>If you are looking for a client to access this CLSI server,
check out the <a href="http://github.com/pacbard/RLatex">Remote LaTeX</a> client.</p>

<a name="accessing-the-clsi"></a><h2>Accessing the CLSI</h2>
<p>An example XML request looks like</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;compile&gt;
    &lt;token&gt;...&lt;/token&gt;
    &lt;options&gt;
        &lt;output-format&gt;pdf&lt;/output-format&gt;
        &lt;compiler&gt;latex&lt;/compiler&gt;
    &lt;/options&gt;
    &lt;resources root-resource-path=&quot;main.tex&quot;&gt;
        &lt;resource path=&quot;main.tex&quot;&gt;&lt;!CDATA[
            \documentclass{article}
            \begin{document}
            Hello world! 
            \input{chapter1.tex}
            \end{document}
        ]&gt;&lt;/resource&gt;
    &lt;/resources&gt;
&lt;/compile&gt;</code></pre>
<p>These requests should be sent as POST requests to /compile, e.g.</p>
<pre><code>curl --data-binary @request.xml http://clsi.example.com/compile</code></pre>
<p>Note that XML is assumed to be the default format unless otherwise specified.</p>

<a name="request-format"></a><h2>Request Format</h2>
<a name="token"></a><h3>Token</h3>
<p>Every request must include your API access token under the <em>token</em> option. This
can currently only be obtained by an email request to the CLSI owner.</p>
<a name="resources"></a><h3>Resources</h3>
<p>Every request must contain a list of <em>resources</em> (files to included in the
compilation), containing at least one resource. Resources must have a <em>path</em>
attribute, and either a <em>content</em> or an <em>url</em> attribute. For XML requests, the
content should be provided as the contents of <resource> tag rather than as an
attribute. More information about each attribute is given below:</p>
<ul>
<li><em>path</em> - This specifies where the file should be written to on disk before
performing the compile. Any directories are created automatically so only the
full file path of each file needs to be supplied.</li>
<li><em>url</em> - An URL where the contents of the file can be downloaded from. The
response from the URL is written verbatim into the file before compilation.
Content downloaded from URLs is cached for an arbitrary length of time so the
URL may not be downloaded with every request to the CLSI. The cache can be
invalidated using the <em>modified</em> property which is explained in more detail
below.</li>
<li><em>content</em> - Alternatively, the file contents may be specified directly. For
speed, it is generally quicker to provide the file contents from URLs where
possible as these can be cached on disk for quicker access.</li>
<li><em>modified</em> - If providing the file via an URL this specifies when the file was
last modified. This should be a string formatted like &quot;YYYY-MM-DD hh:mm:ss&quot;
(TODO: Check if there is an official way to write this). Note that times
should be provided in UTC as the server records when the data was last fetched
in UTC (this is currently regarded as a slight bug. Instead the URL should be
redownloaded if the modified date is ahead of the previously supplied modified
date). If no modified date is provided, a cached version of the URL will
always be used where available.</li>
</ul>
<a name="root-resource-path"></a><h3>Root Resource Path</h3>
<p>This specifies the main file which LaTeX should be run on. LaTeX will
be called with something like</p>
<pre><code>latex &lt;root-resource-path&gt;</code></pre>
<p>The root resource path defaults to &quot;main.tex&quot;.</p>
<a name="options"></a><h3>Options</h3>
<p>The CLSI provides multiple compilers and output formats which can be specified
in the options section.</p>
<p>The request may contain an optional options block:</p>
<pre><code>&lt;options&gt;
    &lt;compiler&gt;latex&lt;/compiler&gt;
    &lt;output-format&gt;ps&lt;/output-format&gt;
&lt;/options&gt;</code></pre>
<p>where you can specify the compiler to use, and the output format. Possible compilers are:</p>
<ul>
<li><code>pdflatex</code> - possible output formats: pdf</li>
<li><code>latex</code> - possible output formats: dvi, ps, pdf</li>
<li><code>xelatex</code> - possible output formats: pdf</li>
<li><code>lualatex</code> - possible output formats: pdf</li>
</ul>
<p>If the compiler and/or the output format are not specified as arguments,
the CLSI will use <code>pdflatex</code> as compiler and <code>pdf</code> as output format. For this
reason, most user will not need to specify a compiler or output formats.</p>

<a name="response-format"></a><h2>Response Format</h2>
<p>The response follows a similar schema to the request, and is returned in the
same format as the request. An example XML response is:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;compile&gt;
  &lt;status&gt;success&lt;/status&gt;
  &lt;output&gt;
    &lt;file type=&quot;pdf&quot; url=&quot;http://clsi.example.com/download/042621e09d8b6fdf9ceaa3c223827/test.pdf&quot; mimetype=&quot;application/pdf&quot;/&gt;
  &lt;/output&gt;
  &lt;logs&gt;
    &lt;file type=&quot;log&quot; url=&quot;http://clsi.example.com/download/042621e09d8b6fdf9ceaa3c223827/test.log&quot; mimetype=&quot;text/plain&quot;/&gt;
  &lt;/logs&gt;
&lt;/compile&gt;</code></pre>
<a name="status"></a><h3>Status</h3>
<p>The status can be either:</p>
<ul>
<li><em>success</em> - The compile ran successfully and an output document was produced.</li>
<li><em>failure</em> - For some reason the compile was unable to run or produce any
output. More information is given in the <em>error</em> attribute explained below.</li>
<li><em>compiling</em> - The compile has not yet finished. See <em>Asynchronous Compiling</em>
below.</li>
</ul>
<a name="errors"></a><h3>Errors</h3>
<p>If there was a problem with the request, or the compile was unable to run for
some reason, the response will contain an error section:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;compile&gt;
  &lt;status&gt;failure&lt;/status&gt;
  &lt;error&gt;
    &lt;type&gt;NoOutputProduced&lt;/type&gt;
    &lt;message&gt;no compiled documents were produced&lt;/message&gt;
  &lt;/error&gt;
  &lt;logs&gt;
    &lt;file type=&quot;log&quot; url=&quot;http://clsi.example.com/download/4c2100ec6ffe6a6dd82792cb507def84/output.log&quot; mimetype=&quot;text/plain&quot;/&gt;
  &lt;/logs&gt;
&lt;/compile&gt;</code></pre>
<p>Possible errors are:</p>
<ul>
<li><em>ParseError</em> - the XML you sent was bad in some way. The message will contain more information</li>
<li><em>InvalidToken</em> - The token you supplied was not correct</li>
<li><em>UnknownCompiler</em> - The compiler you specified is not supported</li>
<li><em>ImpossibleOutputFormat</em> - The output format you specified is not possible with the compiler you specified</li>
<li><em>InvalidPath</em> - One of the paths you supplied for the resources is not valid</li>
<li><em>NoOutputProduced</em> - The compile did not produce any output, most likely due to a problem with your LaTeX syntax. See the returned log for more details</li>
<li><em>Timeout</em> - Part of the compiler process took too long to do and was aborted. Do you have server destroying infinite loops in your LaTeX?</li>
</ul>
<a name="compile-id"></a><h3>Compile ID</h3>
<p>Each request is given a unique ID which is returned as the <em>compile_id</em>
attribute. This can be used to later refer to the same compile. This is mainly
useful when compiling asynchronously (see below).</p>
<a name="output-files-and-logs"></a><h3>Output Files and Logs</h3>
<p>Any output files and logs which are produced are returned in the <em>output_files</em>
and <em>logs</em> attributes respectively. These are collections of items with the
following properites:</p>
<ul>
<li><em>output</em> -  Output file produced by the compiler. The file extension can be specified with the compilation request.</li>
<li><em>log</em> -  LaTeX log file. This will be always be returned by the server regardless of the compilation status.</li>
</ul>

<a name="asynchronous-compiling"></a><h2>Asynchronous Compiling</h2>
<p>By default the HTTP connection is left open until the compile is
finished and then the response is returned. While the CLSI is comparatively fast,
compiling a LaTeX document can still take a long time and this can leave you
with a connection sitting open for a while. </p>
<p>The asynchronous options tells the CLSI to return immediately, before the
compilation is finished. A unique ID is provided which allows you to
poll the server to find out of the compile is complete.</p>
<p>Asynchronous compiling is enabled by passing the <em>asynchronous</em> option in the
request:</p>
<pre><code>&lt;compile&gt;
    &lt;options&gt;
        &lt;asynchronous&gt;true&lt;/asynchronous&gt;
        ...
    &lt;/options&gt;
    ...
&lt;/compile&gt;</code></pre>
<p>The CLSI will return a response immediately, except there will be no files
listed yet, and the status will be <em>compiling</em>. E.g.</p>
<pre><code>{
    &quot;compile&quot; : {
        &quot;status&quot;      : &quot;compiling&quot;,
        &quot;compile_id&quot; : &quot;...&quot;
    }
}</code></pre>
<p>To check on the progress of a compile you can perform a GET request to </p>
<pre><code>http://clsi.example.com/download/&lt;compile-id&gt;/response.xml</code></pre>
<p>depending on the format you would like.</p>
<p>The response will contain a status as above, which will either be <em>compiling</em> if
the compile is still going on, or <em>success</em> or <em>failure</em> if it has finished. Any
output files will be listed when they are available.</p>
<p>We recommend polling at progressively longer intervals, e.g. 0.2s, 0.4s, 0.8s,
1.6s, 3.2s.</p>

<a name="installation"></a><h2>Installation</h2>
<p>To install, just create a new gear with the following commands:</p>
<pre><code>rhc app create clsi -t python-2.6
cd clsi
git remote add upstream -m master https://github.com/pacbard/clsipy.git
git pull -s recursive -X theirs upstream master
git push</code></pre>
<a name="cron"></a><h3>Cron</h3>
<p>Cron can be used to clean up the compiled folder once a day. Just add a cron-1.4 folder to your application with the command</p>
<pre><code>rhc cartridge add cron-1.4 -a clsi</code></pre>
<p>and push your app.</p>

<a name="license"></a><h2>License</h2>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2013 Emanuele Bardelli <a href="&#x6d;&#97;&#x69;&#108;&#116;&#x6f;&#58;&#98;&#x61;&#x72;&#100;&#101;&#x6c;&#108;&#x69;&#x65;&#64;&#x67;&#109;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#x6d;">&#98;&#x61;&#x72;&#100;&#101;&#x6c;&#108;&#x69;&#x65;&#64;&#x67;&#109;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#x6d;</a></p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the &quot;Software&quot;), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>





        </div>
        <footer id="footer">
            Powered by <a href="http://github.com/maximebf/beautiful-docs">beautiful-docs</a> -
            <a href="#top">Back to top</a> - <a href="all.html">Everything on a single page</a>
            - <a href="?print=1">Print current page</a> - <a href="all.html?print=1">Print all pages</a>
            
                <a href="https://github.com/pacbard/clsipy" id="fork-me-on-github">Fork me on Github</a>
            
        </footer>
    </div>
</body>
</html>
